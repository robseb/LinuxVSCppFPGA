<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Altera HWLIB: System Level Cache Management API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="altera-logo.gif"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Altera HWLIB
   &#160;<span id="projectnumber">18.1</span>
   </div>
   <div id="projectbrief">The Altera HW Manager API Reference Manual</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Address&#160;Space</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___c_a_c_h_e___s_y_s.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">System Level Cache Management API</div>  </div>
<div class="ingroups"><a class="el" href="group___c_a_c_h_e___m_g_r.html">Cache Management API</a></div></div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<p>This API group provides cache maintenance operations which affects multiple cache levels.</p>
<p>The enable and disable functions enables and disables all caches in the system respectively. For caches shared by the CPU core(s), particularly the L2 cache, once that cache is enabled or disabled it will not be invalidated or cleaned again respectively. This allows the safe system-wide enable and disable to be used in single-core and multi-core scenarios.</p>
<p>For cache maintenance operations, this API implements the procedures outlined in the L2C-310 Technical Reference Manual, section 3.3.10, subsection "System cache maintenance considerations". This allows for a convenient way to invalidate, clean, or clean and invalidate cache data from the L1 to L2 to L3 while avoiding any potential race conditions in mutli-core or multi-master scenarios. It assumes that the L1 and L2 cache is set in "non-exclusive" mode. This means a segment of data can reside in both the L1 and L2 simultaneously. This is the default mode for caches in the system.</p>
<p>The current implementation of the system cache APIs assumes that the MMU is configured with a flat memory mapping or that every virtual address matches perfectly with the physical address. This restriction may be lifted in a future release of the cache API implementation. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga6f5aef1f8665ce92140f797a40107362"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___c_a_c_h_e___s_y_s.html#ga6f5aef1f8665ce92140f797a40107362">ALT_CACHE_SUPPORT_NON_FLAT_VIRTUAL_MEMORY</a>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:ga6f5aef1f8665ce92140f797a40107362"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga86dd25e6cd718fa78826b612132df84e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___c_a_c_h_e___s_y_s.html#ga86dd25e6cd718fa78826b612132df84e">ALT_CACHE_LINE_SIZE</a>&#160;&#160;&#160;32</td></tr>
<tr class="separator:ga86dd25e6cd718fa78826b612132df84e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga7e2d77afe993421ee6f3ba6a6bc419ee"><td class="memItemLeft" align="right" valign="top">ALT_STATUS_CODE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___c_a_c_h_e___s_y_s.html#ga7e2d77afe993421ee6f3ba6a6bc419ee">alt_cache_system_enable</a> (void)</td></tr>
<tr class="separator:ga7e2d77afe993421ee6f3ba6a6bc419ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1a7fb4dd364afc5a7ae8c68a5d1bdac6"><td class="memItemLeft" align="right" valign="top">ALT_STATUS_CODE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___c_a_c_h_e___s_y_s.html#ga1a7fb4dd364afc5a7ae8c68a5d1bdac6">alt_cache_system_disable</a> (void)</td></tr>
<tr class="separator:ga1a7fb4dd364afc5a7ae8c68a5d1bdac6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga50d87865a68390d96a7f5ddadb465d16"><td class="memItemLeft" align="right" valign="top">ALT_STATUS_CODE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___c_a_c_h_e___s_y_s.html#ga50d87865a68390d96a7f5ddadb465d16">alt_cache_system_invalidate</a> (void *vaddress, size_t length)</td></tr>
<tr class="separator:ga50d87865a68390d96a7f5ddadb465d16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad6f5aeeac2c752c650e9faa1c7df0e97"><td class="memItemLeft" align="right" valign="top">ALT_STATUS_CODE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___c_a_c_h_e___s_y_s.html#gad6f5aeeac2c752c650e9faa1c7df0e97">alt_cache_system_clean</a> (void *vaddress, size_t length)</td></tr>
<tr class="separator:gad6f5aeeac2c752c650e9faa1c7df0e97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa3019ba404096846ee255af73db6e85c"><td class="memItemLeft" align="right" valign="top">ALT_STATUS_CODE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___c_a_c_h_e___s_y_s.html#gaa3019ba404096846ee255af73db6e85c">alt_cache_system_purge</a> (void *vaddress, size_t length)</td></tr>
<tr class="separator:gaa3019ba404096846ee255af73db6e85c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definitions</h2>
<a class="anchor" id="ga6f5aef1f8665ce92140f797a40107362"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ALT_CACHE_SUPPORT_NON_FLAT_VIRTUAL_MEMORY&#160;&#160;&#160;(0)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enables support for a non-flat virtual memory. A flat virtual memory is where every virtual address matches exactly to the physical address, making the virtual to physical translation trivial. Adding support for non-flat adds some overhead for the VA to PA translation and error detection.</p>
<p>To enable non-flat virtual memory support, defined ALT_CACHE_SUPPORT_NON_FLAT_VIRTUAL_MEMORY=1 in your Makefile when compiling HWLibs. </p>

</div>
</div>
<a class="anchor" id="ga86dd25e6cd718fa78826b612132df84e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ALT_CACHE_LINE_SIZE&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the system wide cache line size, given in bytes. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga7e2d77afe993421ee6f3ba6a6bc419ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ALT_STATUS_CODE alt_cache_system_enable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enables all caches and features which improve reliability and speed on all cache controllers visible to the current CPU core. This includes parity error detection. Cache controllers visible to multiple CPU cores, for example the L2, will first be checked to be disabled before being enabled. All necessary cache maintenance operations will be done automatically.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ALT_E_SUCCESS</td><td>The operation was successful. </td></tr>
    <tr><td class="paramname">ALT_E_ERROR</td><td>The operation failed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga1a7fb4dd364afc5a7ae8c68a5d1bdac6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ALT_STATUS_CODE alt_cache_system_disable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Disables all cache controllers visible to the current CPU core. Cache controllers visible to multiple CPU cores, for example the L2, will first be checked to be enabled before being disabled. All necessary cache maintenance operations will be done automatically.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ALT_E_SUCCESS</td><td>The operation was successful. </td></tr>
    <tr><td class="paramname">ALT_E_ERROR</td><td>The operation failed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga50d87865a68390d96a7f5ddadb465d16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ALT_STATUS_CODE alt_cache_system_invalidate </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vaddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Invalidates the specified contents of all cache levels visible to the current CPU core for the given memory segment.</p>
<p>The memory segment address and length specified must align to the characteristics of the cache line. This means the address and length must be multiples of the cache line size. To determine the cache line size, use the <b>ALT_CACHE_LINE_SIZE</b> macro.</p>
<p>The following pseudocode outlines the operations carried out by this function:</p>
<ol type="1">
<li>L2 invalidate address(es)</li>
<li>L2 cache sync</li>
<li>L1 invalidate address(es)</li>
<li>DSB instruction</li>
</ol>
<p>The current implementation of the system cache APIs assumes that the MMU is configured with a flat memory mapping or that every virtual address matches perfectly with the physical address. This restriction may be lifted in a future release of the cache API implementation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vaddress</td><td>The virtual address of the memory segment to be invalidated.</td></tr>
    <tr><td class="paramname">length</td><td>The length of the memory segment to be invalidated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ALT_E_SUCCESS</td><td>The operation was successful. </td></tr>
    <tr><td class="paramname">ALT_E_ERROR</td><td>The operation failed. </td></tr>
    <tr><td class="paramname">ALT_E_BAD_ARG</td><td>The memory segment is invalid. </td></tr>
    <tr><td class="paramname">ALT_E_TMO</td><td>The memory operation timed out. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gad6f5aeeac2c752c650e9faa1c7df0e97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ALT_STATUS_CODE alt_cache_system_clean </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vaddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cleans the specified contents of all cache levels visible to the current CPU core for the given memory segment.</p>
<p>The memory segment address and length specified must align to the characteristics of the cache line. This means the address and length must be multiples of the cache line size. To determine the cache line size, use the <b>ALT_CACHE_LINE_SIZE</b> macro.</p>
<p>The following pseudocode outlines the operations carried out by this function:</p>
<ol type="1">
<li>L1 clean address(es)</li>
<li>DSB instruction</li>
<li>L2 clean address(es)</li>
<li>L2 cache sync</li>
</ol>
<p>The current implementation of the system cache APIs assumes that the MMU is configured with a flat memory mapping or that every virtual address matches perfectly with the physical address. This restriction may be lifted in a future release of the cache API implementation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vaddress</td><td>The virtual address of the memory segment to be cleaned.</td></tr>
    <tr><td class="paramname">length</td><td>The length of the memory segment to be cleaned.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ALT_E_SUCCESS</td><td>The operation was successful. </td></tr>
    <tr><td class="paramname">ALT_E_ERROR</td><td>The operation failed. </td></tr>
    <tr><td class="paramname">ALT_E_BAD_ARG</td><td>The memory segment is invalid. </td></tr>
    <tr><td class="paramname">ALT_E_TMO</td><td>The memory operation timed out. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gaa3019ba404096846ee255af73db6e85c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ALT_STATUS_CODE alt_cache_system_purge </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vaddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cleans and invalidates the specified contents of all cache levels visible to the current CPU core for the given memory segment.</p>
<p>The memory segment address and length specified must align to the characteristics of the cache line. This means the address and length must be multiples of the cache line size. To determine the cache line size, use the <b>ALT_CACHE_LINE_SIZE</b> macro.</p>
<p>The following pseudocode outlines the operations carried out by this function:</p>
<ol type="1">
<li>L1 clean address(es)</li>
<li>DSB instruction</li>
<li>L2 clean and invalidate address(es)</li>
<li>L2 cache sync</li>
<li>L1 invalidate address(es)</li>
<li>DSB instruction</li>
</ol>
<p>The current implementation of the system cache APIs assumes that the MMU is configured with a flat memory mapping or that every virtual address matches perfectly with the physical address. This restriction may be lifted in a future release of the cache API implementation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vaddress</td><td>The virtual address of the memory segment to be purged.</td></tr>
    <tr><td class="paramname">length</td><td>The length of the memory segment to be purged.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ALT_E_SUCCESS</td><td>The operation was successful. </td></tr>
    <tr><td class="paramname">ALT_E_ERROR</td><td>The operation failed. </td></tr>
    <tr><td class="paramname">ALT_E_BAD_ARG</td><td>The memory segment is invalid. </td></tr>
    <tr><td class="paramname">ALT_E_TMO</td><td>The memory operation timed out. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Sep 13 2018 01:57:45 for Altera HWLIB by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.2 </li>
  </ul>
</div>
</body>
</html>
